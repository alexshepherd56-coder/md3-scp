<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2022 SAQ Exam - MD3 SCP</title>

  <link rel="icon" type="image/png" href="../assets/ShepTech logo.png">
  <link rel="stylesheet" href="../css/main.css?v=20251109-1">

  <style>
    /* Exam-specific styles - Examplify-inspired */
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
    }

    .exam-container {
      display: flex;
      height: 100vh;
      background: var(--claude-cream);
    }

    /* Sidebar with question navigation */
    .exam-sidebar {
      width: 280px;
      background: var(--claude-sidebar);
      border-right: 1px solid var(--claude-border);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    .exam-header {
      padding: 24px 20px;
      border-bottom: 1px solid var(--claude-border);
      background: var(--claude-card-bg);
    }

    .exam-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--claude-text);
      margin: 0 0 8px 0;
    }

    .exam-subtitle {
      font-size: 13px;
      color: var(--claude-secondary);
      margin: 0;
    }

    .question-nav {
      padding: 16px;
      flex: 1;
      overflow-y: auto;
    }

    .question-nav-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--claude-secondary);
      margin: 0 0 12px 0;
      padding: 0 8px;
    }

    .question-nav-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }

    .question-nav-btn {
      aspect-ratio: 1;
      border: 1px solid var(--claude-border);
      background: var(--claude-card-bg);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--claude-text);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .question-nav-btn:hover {
      border-color: var(--claude-accent);
      background: var(--claude-light-accent);
    }

    .question-nav-btn.active {
      background: var(--claude-accent);
      color: white;
      border-color: var(--claude-accent);
    }

    .question-nav-btn.answered {
      background: #4CAF50;
      color: white;
      border-color: #4CAF50;
    }

    .question-nav-btn.flagged {
      border: 2px solid #ff6b6b;
    }

    .exam-footer {
      padding: 16px 20px;
      border-top: 1px solid var(--claude-border);
      background: var(--claude-card-bg);
    }

    .submit-exam-btn {
      width: 100%;
      padding: 12px;
      background: var(--claude-accent);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .submit-exam-btn:hover {
      background: var(--claude-hover);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(204, 120, 92, 0.25);
    }

    /* Main exam content area */
    .exam-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .exam-top-bar {
      background: var(--claude-sidebar);
      border-bottom: 1px solid var(--claude-border);
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .exam-progress {
      font-size: 14px;
      color: var(--claude-secondary);
      font-weight: 500;
    }

    .exam-timer {
      font-size: 16px;
      font-weight: 600;
      color: var(--claude-text);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .question-display {
      flex: 1;
      overflow-y: auto;
      padding: 40px 48px;
      background: var(--claude-cream);
    }

    .question-content {
      max-width: 900px;
      margin: 0 auto;
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
    }

    .question-number {
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--claude-secondary);
    }

    .flag-question-btn {
      padding: 8px 16px;
      background: transparent;
      border: 1.5px solid var(--claude-border);
      border-radius: 8px;
      color: var(--claude-text);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .flag-question-btn:hover {
      border-color: #ff6b6b;
      background: rgba(255, 107, 107, 0.05);
      color: #ff6b6b;
    }

    .flag-question-btn.flagged {
      background: #ff6b6b;
      border-color: #ff6b6b;
      color: white;
    }

    .question-text {
      font-size: 18px;
      line-height: 1.7;
      color: var(--claude-text);
      margin-bottom: 32px;
      padding: 24px;
      background: var(--claude-card-bg);
      border: 1px solid var(--claude-border);
      border-radius: 12px;
    }

    .answer-area {
      margin-top: 32px;
    }

    .answer-area label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--claude-text);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .answer-input {
      width: 100%;
      min-height: 300px;
      padding: 20px;
      border: 1px solid var(--claude-border);
      border-radius: 12px;
      font-family: var(--font-sans);
      font-size: 15px;
      line-height: 1.7;
      color: var(--claude-text);
      background: var(--claude-card-bg);
      resize: vertical;
      transition: all 0.2s ease;
    }

    .answer-input:focus {
      outline: none;
      border-color: var(--claude-accent);
      box-shadow: 0 0 0 3px rgba(204, 120, 92, 0.1);
    }

    .question-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 32px;
      padding-top: 32px;
      border-top: 1px solid var(--claude-border);
    }

    .nav-btn {
      padding: 12px 24px;
      background: var(--claude-card-bg);
      border: 1.5px solid var(--claude-border);
      border-radius: 8px;
      color: var(--claude-text);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .nav-btn:hover {
      background: var(--claude-light-accent);
      border-color: var(--claude-accent);
    }

    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .nav-btn.primary {
      background: var(--claude-accent);
      color: white;
      border-color: var(--claude-accent);
    }

    .nav-btn.primary:hover {
      background: var(--claude-hover);
      border-color: var(--claude-hover);
    }

    /* Back to Home Button */
    .back-home-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 8px 16px;
      background: var(--claude-card-bg);
      border: 1.5px solid var(--claude-border);
      border-radius: 8px;
      color: var(--claude-text);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .back-home-btn:hover {
      background: var(--claude-light-accent);
      border-color: var(--claude-accent);
      transform: translateY(-1px);
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-home-btn">
    <span>‚Üê</span> Back to Home
  </a>

  <div class="exam-container">
    <!-- Sidebar with question navigation -->
    <div class="exam-sidebar">
      <div class="exam-header">
        <h1 class="exam-title">2022 SAQ Exam</h1>
        <p class="exam-subtitle">MD3 Practice Examination</p>
      </div>

      <div class="question-nav">
        <h2 class="question-nav-title">Questions</h2>
        <div class="question-nav-grid" id="questionNavGrid">
          <!-- Question buttons will be generated by JavaScript -->
        </div>
      </div>

      <div class="exam-footer">
        <button class="submit-exam-btn" id="submitExamBtn">Submit Exam</button>
      </div>
    </div>

    <!-- Main content area -->
    <div class="exam-content">
      <div class="exam-top-bar">
        <div class="exam-progress" id="examProgress">Question 1 of 10</div>
        <div class="exam-timer" id="examTimer">
          <span>‚è±</span>
          <span id="timerDisplay">00:00:00</span>
        </div>
      </div>

      <div class="question-display">
        <div class="question-content" id="questionContent">
          <div class="question-header">
            <div class="question-number" id="questionNumber">Question 1</div>
            <button class="flag-question-btn" id="flagQuestionBtn">
              <span>üö©</span>
              <span>Flag Question</span>
            </button>
          </div>

          <div class="question-text" id="questionText">
            <!-- Question text will be loaded here -->
            Loading question...
          </div>

          <div class="answer-area">
            <label for="answerInput">Your Answer</label>
            <textarea
              id="answerInput"
              class="answer-input"
              placeholder="Type your answer here..."
            ></textarea>
          </div>

          <div class="question-actions">
            <button class="nav-btn" id="prevBtn">‚Üê Previous</button>
            <button class="nav-btn primary" id="nextBtn">Next ‚Üí</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Exam data structure
    const examData = {
      title: '2022 SAQ Exam',
      totalQuestions: 10,
      questions: [
        {
          id: 1,
          text: 'A 65-year-old patient presents with chest pain. Describe your approach to investigating this patient, including relevant history, examination findings you would look for, and initial investigations you would order.',
          answer: '',
          flagged: false
        },
        {
          id: 2,
          text: 'Discuss the management of a patient with newly diagnosed Type 2 Diabetes Mellitus. Include both pharmacological and non-pharmacological interventions.',
          answer: '',
          flagged: false
        },
        {
          id: 3,
          text: 'A patient presents with acute shortness of breath. Outline your differential diagnosis and explain your systematic approach to narrowing down the diagnosis.',
          answer: '',
          flagged: false
        },
        {
          id: 4,
          text: 'Explain the pathophysiology of heart failure and describe the key differences between systolic and diastolic heart failure.',
          answer: '',
          flagged: false
        },
        {
          id: 5,
          text: 'A 45-year-old patient has been diagnosed with hypertension. Discuss the lifestyle modifications you would recommend and when you would consider starting pharmacological treatment.',
          answer: '',
          flagged: false
        },
        {
          id: 6,
          text: 'Describe the investigation and management of a patient with suspected acute coronary syndrome.',
          answer: '',
          flagged: false
        },
        {
          id: 7,
          text: 'Discuss the complications of chronic kidney disease and how they should be managed.',
          answer: '',
          flagged: false
        },
        {
          id: 8,
          text: 'A patient presents with sudden onset of severe headache. Outline your approach to this presentation including red flags you would assess for.',
          answer: '',
          flagged: false
        },
        {
          id: 9,
          text: 'Explain the principles of anticoagulation therapy and discuss the key considerations when initiating a patient on warfarin.',
          answer: '',
          flagged: false
        },
        {
          id: 10,
          text: 'Describe the assessment and management of a patient presenting with suspected sepsis.',
          answer: '',
          flagged: false
        }
      ]
    };

    // State management
    let currentQuestionIndex = 0;
    let startTime = Date.now();
    let timerInterval;

    // Initialize exam
    function initExam() {
      generateQuestionNav();
      loadQuestion(0);
      startTimer();
      loadProgress();
    }

    // Generate question navigation buttons
    function generateQuestionNav() {
      const navGrid = document.getElementById('questionNavGrid');
      navGrid.innerHTML = '';

      examData.questions.forEach((q, index) => {
        const btn = document.createElement('button');
        btn.className = 'question-nav-btn';
        btn.textContent = index + 1;
        btn.dataset.questionIndex = index;

        if (q.answered) btn.classList.add('answered');
        if (q.flagged) btn.classList.add('flagged');
        if (index === currentQuestionIndex) btn.classList.add('active');

        btn.addEventListener('click', () => loadQuestion(index));
        navGrid.appendChild(btn);
      });
    }

    // Load a specific question
    function loadQuestion(index) {
      // Save current answer before switching
      if (currentQuestionIndex !== index) {
        saveCurrentAnswer();
      }

      currentQuestionIndex = index;
      const question = examData.questions[index];

      document.getElementById('questionNumber').textContent = `Question ${index + 1}`;
      document.getElementById('questionText').textContent = question.text;
      document.getElementById('answerInput').value = question.answer || '';
      document.getElementById('examProgress').textContent = `Question ${index + 1} of ${examData.totalQuestions}`;

      // Update flag button
      const flagBtn = document.getElementById('flagQuestionBtn');
      if (question.flagged) {
        flagBtn.classList.add('flagged');
        flagBtn.innerHTML = '<span>üö©</span><span>Flagged</span>';
      } else {
        flagBtn.classList.remove('flagged');
        flagBtn.innerHTML = '<span>üö©</span><span>Flag Question</span>';
      }

      // Update navigation buttons
      document.getElementById('prevBtn').disabled = index === 0;
      document.getElementById('nextBtn').disabled = index === examData.totalQuestions - 1;

      generateQuestionNav();
      saveProgress();
    }

    // Save current answer
    function saveCurrentAnswer() {
      const answerInput = document.getElementById('answerInput');
      examData.questions[currentQuestionIndex].answer = answerInput.value;
      examData.questions[currentQuestionIndex].answered = answerInput.value.trim() !== '';
      saveProgress();
    }

    // Timer
    function startTimer() {
      timerInterval = setInterval(() => {
        const elapsed = Date.now() - startTime;
        const hours = Math.floor(elapsed / 3600000);
        const minutes = Math.floor((elapsed % 3600000) / 60000);
        const seconds = Math.floor((elapsed % 60000) / 1000);

        document.getElementById('timerDisplay').textContent =
          `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
      }, 1000);
    }

    // Save progress to localStorage
    function saveProgress() {
      localStorage.setItem('saq-2022-progress', JSON.stringify({
        currentQuestionIndex,
        startTime,
        questions: examData.questions
      }));
    }

    // Load progress from localStorage
    function loadProgress() {
      const saved = localStorage.getItem('saq-2022-progress');
      if (saved) {
        const progress = JSON.parse(saved);
        currentQuestionIndex = progress.currentQuestionIndex;
        startTime = progress.startTime;
        examData.questions = progress.questions;
        loadQuestion(currentQuestionIndex);
      }
    }

    // Event listeners
    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentQuestionIndex > 0) {
        loadQuestion(currentQuestionIndex - 1);
      }
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      if (currentQuestionIndex < examData.totalQuestions - 1) {
        loadQuestion(currentQuestionIndex + 1);
      }
    });

    document.getElementById('flagQuestionBtn').addEventListener('click', () => {
      examData.questions[currentQuestionIndex].flagged = !examData.questions[currentQuestionIndex].flagged;
      loadQuestion(currentQuestionIndex);
    });

    document.getElementById('answerInput').addEventListener('input', () => {
      saveCurrentAnswer();
      generateQuestionNav();
    });

    document.getElementById('submitExamBtn').addEventListener('click', () => {
      saveCurrentAnswer();
      const answered = examData.questions.filter(q => q.answered).length;
      const unanswered = examData.totalQuestions - answered;

      let message = `You have answered ${answered} out of ${examData.totalQuestions} questions.`;
      if (unanswered > 0) {
        message += `\n\n${unanswered} question(s) remain unanswered.`;
      }
      message += '\n\nAre you sure you want to submit your exam?';

      if (confirm(message)) {
        alert('Exam submitted successfully! (Results will be available soon)');
        localStorage.removeItem('saq-2022-progress');
        window.location.href = '../index.html';
      }
    });

    // Auto-save every 30 seconds
    setInterval(saveCurrentAnswer, 30000);

    // Initialize on load
    initExam();
  </script>
</body>
</html>
